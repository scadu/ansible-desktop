---
- name: Install 1Password
  block:
    - name: Add 1Password GPG key
      ansible.builtin.apt_key:
        url: https://downloads.1password.com/linux/keys/1password.asc
        state: present
      become: true

    - name: Add 1Password repository
      ansible.builtin.apt_repository:
        repo: deb [arch=amd64] https://downloads.1password.com/linux/debian/amd64 stable main
        state: present
        filename: 1password
      become: true

    - name: Install 1Password
      ansible.builtin.apt:
        name:
          - 1password
          - 1password-cli
        state: present
        update_cache: yes
      become: true