---
- name: zomg desktop
  hosts: all

  roles:
  - role: workstation
    tags: ['workstation']


    vars:
    # available params: "desktop", "wsl"
    # see available files in vars/
    install_type: "desktop"

  pre_tasks:
    - name: prepare system
      become: yes

      block:
        - name: upgrade system packages
          apt:
            update_cache: yes
            upgrade: dist

        - name: install packages to allow apt to use a repo over https
          apt:
            name: "{{ item }}"
            state: present
          with_items:
            - apt-transport-https
            - ca-certificates
            - curl
            - gnupg-agent
            - software-properties-common
          tags:
            - pre_tasks

  post_tasks:
    - name: check if reboot required

      block:
       - name: check if reboot required
         stat:
          path: "/var/run/reboot-required"
         register: reboot_required

       - debug:
            msg: "Reboot required!"
         when: reboot_required.stat.isreg is defined
      tags:
        - post_tasks
